"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const hsnode_1 = require("hsnode");
const srcDir = 'data/';
const destDir = '../../../../staging/apps/hsStock/private/';
const wb = hsnode_1.hsExcel.readFile(srcDir + 'investments.xlsx');
const table = wb.getTable(wb.getSheetNames()[0], 'F', 9);
const symbols = table.columns.names;
symbols.shift();
const transactions = {};
let numTrans = 0;
for (let c = 0; c < symbols.length; c++) {
    const sym = symbols[c];
    transactions[sym] = [];
    let previous = 0;
    for (let r = 0; r < table.table.length; r++) {
        const date = table.table[r][0];
        let num = parseFloat(table.table[r][c + 1]);
        if (isNaN(num)) {
            num = 0;
        }
        if (num !== previous) {
            transactions[sym].push({ date: date, change: num - previous, total: num });
            previous = num;
            numTrans++;
        }
    }
    if (previous < 0) {
        console.log(`invalid final shares for ${sym}: ${previous}`);
    }
}
hsnode_1.fsUtil.writeJsonFile(destDir + 'transactions.json', transactions).catch(console.log);
console.log(`wrote transactions.json, ${numTrans} transactions`);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udmVydEludmVzdG1lbnRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvbnZlcnRJbnZlc3RtZW50cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUEwQztBQUUxQyxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUM7QUFDdkIsTUFBTSxPQUFPLEdBQUcsMkNBQTJDLENBQUM7QUFDNUQsTUFBTSxFQUFFLEdBQUcsZ0JBQU8sQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFDLGtCQUFrQixDQUFDLENBQUM7QUFDdkQsTUFBTSxLQUFLLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBRXpELE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDO0FBQ3BDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUVoQixNQUFNLFlBQVksR0FBRyxFQUFFLENBQUM7QUFDeEIsSUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDO0FBRWpCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFDLENBQUMsRUFBRSxDQUFDLEdBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO0lBQ2xDLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN2QixZQUFZLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBQ3ZCLElBQUksUUFBUSxHQUFHLENBQUMsQ0FBQztJQUNqQixHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDdEMsTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMvQixJQUFJLEdBQUcsR0FBRyxVQUFVLENBQVMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztRQUFDLENBQUM7UUFDNUIsRUFBRSxDQUFDLENBQUMsR0FBRyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDbkIsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLEdBQUcsR0FBQyxRQUFRLEVBQUUsS0FBSyxFQUFDLEdBQUcsRUFBQyxDQUFDLENBQUM7WUFDdEUsUUFBUSxHQUFHLEdBQUcsQ0FBQztZQUNmLFFBQVEsRUFBRSxDQUFDO1FBQ2YsQ0FBQztJQUNMLENBQUM7SUFDRCxFQUFFLENBQUMsQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNmLE9BQU8sQ0FBQyxHQUFHLENBQUMsNEJBQTRCLEdBQUcsS0FBSyxRQUFRLEVBQUUsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7QUFDTCxDQUFDO0FBQ0QsZUFBTSxDQUFDLGFBQWEsQ0FBQyxPQUFPLEdBQUMsbUJBQW1CLEVBQUUsWUFBWSxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNuRixPQUFPLENBQUMsR0FBRyxDQUFDLDRCQUE0QixRQUFRLGVBQWUsQ0FBQyxDQUFDIn0=